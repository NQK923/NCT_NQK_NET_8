<div class=" bg-img">
  <div id="head">
    <div class="row max-w-full bg-black opacity-90">
      <div class="col-8  p-2 flex items-center">
        <div>
          <img alt="Logo" class="hidden xl:block ml-4 img cursor-pointer" src="https://mangaimg.blob.core.windows.net/assets/logo4.png">
        </div>
        <ul class="flex mt-3 ">
          <li (click)="goToIndex()"
              class="text-lg font-bold items-center text-gray-100 mx-3 hover:text-yellow-500 cursor-pointer">
            Trang chủ
          </li>
          <li (click)="goToListView()"
              class="text-lg font-bold items-center text-gray-100 mx-3 hover:text-yellow-500 cursor-pointer">
            Danh sách truyện
          </li>
          <li (click)="goToRank()"
              class="text-lg font-bold items-center text-gray-100 mx-3 hover:text-yellow-500 cursor-pointer">Xếp
            hạng
          </li>
          <li (click)="goToHistory()" id="History"
              class="text-lg font-bold items-center text-gray-100 mx-3 hover:text-yellow-500 cursor-pointer">
            Lịch sử đọc
          </li>
          <li (click)="goToFavorite()" id="Favorite"
              class="text-lg font-bold items-center text-gray-100 mx-3 hover:text-yellow-500 cursor-pointer">
            Yêu thích
          </li>
          <li (click)="goToLogin()" id="Login"
              class="text-lg font-bold items-center text-gray-100 mx-3 hover:text-yellow-500 cursor-pointer">Đăng
            nhập
          </li>
        </ul>
      </div>
      <div class="col-4 bg-opacity-80 p-2 flex items-center justify-end">
        <input
          (keyup.enter)="onSearch()"
          [(ngModel)]="searchQuery"
          class="text-lg px-2 rounded-lg m-2 bg-black bg-opacity-80 text-white hover:text-yellow-500 transition-all duration-300 w-80 input-transition"
          onblur="this.classList.remove('w-full')"
          onfocus="this.classList.add('w-full')"
          placeholder="Tìm kiếm"
          type="text">
        <div id="clientManager" (click)="goToClientManager()" class="cursor-pointer">
          <div class="h-14 w-14 bg-white rounded-full overflow-hidden border">
            <img alt="Avatar" class="h-14 w-14 p-0 object-cover flex" src="{{url}}">
          </div>
          <div class="text-white text-sm text-center">{{ name }}</div>
        </div>
        <div id="iconNotification" (click)="goToNotification()" class="flex px-2 cursor-pointer">
          <img alt="Bell Icon" class="h-14" src="https://mangaimg.blob.core.windows.net/assets/icons8-bell-100.png">
          <h1 class="h-1 w-1 text-sm rounded-full text-red-500 -ml-4 font-bold">+{{ numberNotification }}</h1>
        </div>
      </div>
    </div>
  </div>
</div>
<!-- Notification Component -->
<div [class.hidden]="isHidden"
     id="Notification" class="fixed inset-0 flex justify-end items-start z-20 p-6 bg-opacity-40 bg-gray-700">
  <div class="bg-white w-[500px] max-h-[80vh] rounded-lg shadow-lg overflow-hidden">
    <!-- Header -->
    <div class="flex items-center justify-between rounded-t-lg bg-gradient-to-r from-blue-800 to-gray-500 px-4 py-2">
      <h2 class="text-2xl font-bold text-white">Thông báo</h2>
      <button (click)="toggleNotification()" class="px-4 py-1 font-bold text-white bg-blue-500 rounded cursor-pointer">Thoát</button>
    </div>

    <!-- Clear All Notifications Button -->
    <div *ngIf="ListCombinedData.length || ListCombinedDataIsRead.length" (click)="deleteAllNotification()"
         class="flex justify-center py-2 text-blue-500 underline cursor-pointer hover:text-blue-700">
      Xóa tất cả thông báo
    </div>

    <!-- No New Notifications Message -->
    <div *ngIf="!ListCombinedData.length && !ListCombinedDataIsRead.length" class="p-4 text-center text-gray-500">
      Không có thông báo mới
    </div>

    <!-- Notifications Section with Scroll -->
    <div class="px-4 pb-4 max-h-[60vh] overflow-y-auto">
      <!-- Unread Notifications -->
      <ng-container *ngIf="ListCombinedData.length">
        <h4 class="font-bold text-black">Mới nhất</h4>
        <div *ngFor="let data of ListCombinedData"
             (click)="goToContent(data.Mangainfo?.id_manga, data.NotificationMangaAccounts?.id_Notification)"
             class="flex items-center p-2 mt-2 bg-gray-100 rounded-lg hover:bg-gray-200 cursor-pointer">
          <div class="h-14 w-14 overflow-hidden rounded-full border">
            <img alt="Avatar" class="object-cover w-full h-full" src="{{ data.Mangainfo?.cover_img }}">
          </div>
          <div class="ml-4">
            <p class="font-bold text-blue-500 text-sm">{{ data.Mangainfo?.name }} {{ data.Notification?.type_Noti }}</p>
            <p class="text-sm">{{ data.Notification?.content }}</p>
            <p class="text-sm text-blue-500">{{ data.Notification?.time | date: 'HH:mm dd/MM/yyyy' }}</p>
          </div>
        </div>
      </ng-container>

      <!-- Read Notifications -->
      <ng-container *ngIf="ListCombinedDataIsRead.length">
        <h4 class="mt-4 font-bold text-black">Đã đọc</h4>
        <div *ngFor="let oldData of ListCombinedDataIsRead"
             (click)="goToContent(oldData.Mangainfo?.id_manga, oldData.NotificationMangaAccounts?.id_Notification)"
             class="flex items-center p-2 mt-2 bg-gray-100 rounded-lg hover:bg-gray-200 cursor-pointer opacity-50">
          <div class="h-14 w-14 overflow-hidden rounded-full border">
            <img alt="Avatar" class="object-cover w-full h-full" src="{{ oldData.Mangainfo?.cover_img }}">
          </div>
          <div class="ml-4">
            <p class="font-bold text-blue-500 text-sm">{{ oldData.Mangainfo?.name }} {{ oldData.Notification?.type_Noti }}</p>
            <p class="text-sm">{{ oldData.Notification?.content }}</p>
            <p class="text-sm text-blue-500">{{ oldData.Notification?.time | date: 'HH:mm dd/MM/yyyy' }}</p>
          </div>
        </div>
      </ng-container>
    </div>
  </div>
</div>
<p-confirmDialog #cd>
  <ng-template let-message pTemplate="headless">
    <div class="flex flex-column align-items-center pb-4 border-round bg-gray-800 rounded">
      <div class="w-full bg-gray-900 p-3 rounded-top">
        <span class="font-bold text-3xl text-white mb-3">{{ message.header }}</span>
      </div>
      <div class="flex align-items-center gap-3 mb-3 pt-2 mx-4">
        <i class="pi pi-question text-red-500 text-2xl"></i>
        <p class="text-lg text-gray-100 mb-0">{{ message.message }}</p>
      </div>
      <div class="flex justify-content-center gap-2 mt-4">
        <button
          (click)="cd.accept()"
          class="w-20 rounded py-1 px-2 bg-blue-600 hover:bg-blue-700 text-white"
          label="Đồng ý"
          pButton>
        </button>
        <button
          (click)="cd.reject()"
          class="p-button-outlined w-20 rounded py-1 px-2 border-1 border-gray-400 bg-transparent hover:bg-gray-800 text-gray-200"
          label="Huỷ"
          pButton>
        </button>
      </div>
    </div>
  </ng-template>
</p-confirmDialog>
<p-toast></p-toast>
